<div class="container mt-4">
    <h2>Projects</h2>
  
    <!-- Search Bar -->
    <div class="search-container mb-4">
      <div class="row g-3">
        <div class="col-md-6">
          <input
            type="text"
            class="form-control"
            placeholder="Search by project name..."
            [(ngModel)]="searchTerm"
            (input)="searchProjects()"
          />
        </div>
        <div class="col-md-6">
          <input
            type="text"
            class="form-control"
            placeholder="Search by category..."
            [(ngModel)]="searchTerm2"
            (input)="searchProjects()"
          />
        </div>
      </div>
    </div>
  
    <!-- Investment Dialog -->
    <div *ngIf="showInvestmentForm" class="investment-dialog">
      <h3>Make an Investment</h3>
      <form (ngSubmit)="processInvestment()">
        <div class="form-group">
          <label for="investmentAmount">Investment Amount ($)</label>
          <input
            type="number"
            id="investmentAmount"
            name="investmentAmount"
            [(ngModel)]="investmentAmount"
            [min]="1"
            required
          />
        </div>
  
        <div class="form-group">
          <label for="cardNumber">Card Number</label>
          <input
            type="text"
            id="cardNumber"
            name="cardNumber"
            [(ngModel)]="paymentDetails.cardNumber"
            placeholder="1234 5678 9012 3456"
            required
          />
        </div>
  
        <div class="form-row">
          <div class="form-group">
            <label for="expiryDate">Expiry Date</label>
            <input
              type="text"
              id="expiryDate"
              name="expiryDate"
              [(ngModel)]="paymentDetails.expiryDate"
              placeholder="MM/YY"
              required
            />
          </div>
  
          <div class="form-group">
            <label for="cvv">CVV</label>
            <input
              type="text"
              id="cvv"
              name="cvv"
              [(ngModel)]="paymentDetails.cvv"
              placeholder="123"
              required
            />
          </div>
        </div>
  
        <div class="form-group">
          <label for="cardName">Name on Card</label>
          <input
            type="text"
            id="cardName"
            name="cardName"
            [(ngModel)]="paymentDetails.cardName"
            placeholder="John Doe"
            required
          />
        </div>
  
        <div class="investment-summary">
          <p><strong>Project:</strong> {{ selectedProject?.project_title }}</p>
          <p><strong>Goal:</strong> ${{ selectedProject?.goal_amount }}</p>
          <p><strong>Raised:</strong> ${{ selectedProject?.raised_amount || 0 }}</p>
          <p><strong>Your Investment:</strong> ${{ investmentAmount }}</p>
        </div>
  
        <div class="investment-actions">
          <button type="submit" class="btn btn-primary">Confirm Investment</button>
          <button type="button" class="btn btn-primary" (click)="cancelInvestment()">Cancel</button>
        </div>
      </form>
    </div>
  
    <!-- Project Cards -->
    <div class="row">
      <div class="col-md-4 mb-4" *ngFor="let project of filteredProjects">
        <div class="card h-100">
          <div class="card-body">
            <h5 class="card-title">{{ project.project_title }}</h5>
            <h6 class="card-subtitle mb-2 text-muted">{{ project.project_category }}</h6>
            <p class="card-text">{{ project.project_description }}</p>
  
            <div class="mb-2"><strong>Goal:</strong> ${{ project.goal_amount }}</div>
            <div class="mb-2"><strong>Raised:</strong> ${{ project.raised_amount || 0 }}</div>
            <div class="mb-2"><strong>Status:</strong> {{ project.project_status }}</div>
            <div class="mb-2"><strong>Start:</strong> {{ project.start_date | date }}</div>
            <div class="mb-2"><strong>End:</strong> {{ project.end_date | date }}</div>
  
            <!-- Progress Bar -->
            <div class="progress-container mt-3">
              <div
                class="progress-bar"
                [style.width.%]="(project.raised_amount / project.goal_amount) * 100"
              >
                {{
                  (project.raised_amount / project.goal_amount) * 100
                    | number : '1.0-0'
                }}%
              </div>
            </div>
          </div>
  
          <div class="card-footer d-flex justify-content-between">
            <button
              *ngIf="isInvestor"
              class="btn btn-primary"
              (click)="showInvestmentDialog(project)"
            >
              Invest
            </button>
            <button
              *ngIf="isAdmin"
              class="btn btn-primary"
              (click)="deleteProject(project.project_id)"
            >
              Delete
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  